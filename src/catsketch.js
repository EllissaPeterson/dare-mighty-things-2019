import globalAudio from './globalAudio'

export default function sketch (p) {
    let t = 0; // time variable
    let c = 0;
    let inOut = false;
    let numPoints = 0;
    let stepTime = 0;
    let travelTime = 0.05;
    let totalTime = 1.5;
    let waitTime = 0.5;

    let scalar = 4.0;
    let wave = 0.5;
    let rot = 0;
    let relOrX = 0;
    let relOrY = 0;
    let xVel = 4;
    let yVel = 4;


    let red1 = p.color(255, 35, 79);
    let red2 = p.color(255, 126, 27);
    let green1 = p.color(20, 209, 190);
    let green2 = p.color(0, 102, 204);
    let dark = p.color(30, 200, 0);

    let randData = [
        152,
        165,
        173,
        164,
        174,
        188,
        189,
        205,
        191,
        209,
        221,
        217,
        228,
        214,
        201,
        219,
        221,
        217,
        221,
        224,
        228,
        228,
        214,
        198,
        200,
        208,
        221,
        220,
        204,
        195,
        187,
        182,
        197,
        186,
        167,
        163,
        170,
        158,
        153,
        135,
        138,
        133,
        139,
        126,
        126,
        120,
        131,
        117,
        136,
        128,
        148,
        166,
        151,
        148,
        142,
        157,
        139,
        148,
        128,
        109,
        113,
        101,
        106,
        102,
        119,
        104,
        97,
        97,
        87,
        88,
        102,
        86,
        98,
        94,
        97,
        79,
        96,
        113,
        110,
        99,
        92,
        77,
        96,
        112,
        114,
        132,
        148,
        159,
        172,
        190,
        208,
        196,
        188,
        178,
        180,
        200,
        209,
        221,
        223,
        206,
        186,
        206,
        226,
        207,
        204,
        197,
        187,
        186,
        168,
        170,
        166,
        169,
        151,
        132,
        141,
        129,
        112,
        98,
        93,
        85,
        88,
        94,
        77,
        79,
        87,
        68,
        56,
        61,
        41,
        32,
        37,
        49,
        66,
        67,
        59,
        60,
        56,
        66,
        62,
        59,
        67,
        48,
        34,
        29,
        30,
        48,
        37,
        37,
        56,
        69,
        74,
        77,
        97,
        84,
        98,
        100,
        107,
        101,
        118,
        103,
        102,
        98,
        94,
        96,
        77,
        92,
        89,
        96,
        95,
        75,
        57,
        69,
        68,
        63,
        79,
        90,
        71,
        68,
        76,
        96,
        95,
        106,
        111,
        122,
        123,
        123,
        129,
        119,
        124,
        134,
        121,
        135,
        120,
        124,
        128,
        139,
        149,
        160,
        142,
        146,
        129
    ]

    let data = [
        [101.6366075781753, 1.9860236623501282],
        [99.62429422585637, 1.9084185641833287],
        [97.52948272189288, 1.8406454827333658],
        [95.70788891204319, 1.7599953488948648],
        [94.53041838477179, 1.6767806847844964],
        [94.08506789071261, 1.6133238614146808],
        [94.04786015641186, 1.5388922623098742],
        [93.90420650854784, 1.4319113112746835],
        [94.14881836751856, 1.356735643231075],
        [96.46242791885346, 1.2654377467062596],
        [96.93296652842108, 1.1902899496825317],
        [97.12878049270464, 1.0656978197358995],
        [97.9081201943945, 0.9742953442750709],
        [95.13148795220224, 0.8747121563906705],
        [94.04786015641186, 0.7929168187097522],
        [92.9569792968769, 0.7016252196536817],
        [90.69729874698585, 0.5971766580926776],
        [86.35392289873113, 0.4947256824842485],
        [83.57032966310472, 0.3671738338182192],
        [79.55501241279521, 0.2541247495556341],
        [73.97972695272672, 0.16292645885037274],
        [70.06425622241343, 0.042830932668727326],
        [69.00724599634447, 0.014491739065500022],
        [76.32168761236873, -0.0918461262647375],
        [79.83107164506812, -0.21459288149122355],
        [85.38149682454625, -0.3217505543966422],
        [90.07774419910837, -0.3990609485761339],
        [95.25754563287887, -0.46834241018830125],
        [101.87246929372037, -0.5471534052187033],
        [106.25441167311595, -0.6114969742595617],
        [110.11357772772621, -0.6889243882148613],
        [111.73182178770737, -0.7727406115633964],
        [108.97706180660222, -0.8243395064944876],
        [102.7277956543408, -0.8473876045919684],
        [96.42613753542138, -0.85879548929906],
        [88.86506625215557, -0.88902562339432],
        [81.05553651663777, -0.8902751021276822],
        [70.43436661176133, -0.8960553845713439],
        [63.89053137985315, -0.8740540452648857],
        [58.89821729050889, -0.8695364039286192],
        [55.226805085936306, -1.0179551052023572],
        [54.230987451824994, -1.1731683352727673],
        [53.600373133029585, -1.3258176636680326],
        [52.009614495783374, -1.5515679276951895],
        [54.230987451824994, -1.4784669920632976],
        [53.46026561849464, 4.581073541401602],
        [54.817880294662984, 4.454136760573651],
        [57.9396237474839, 4.341497691572028],
        [63.06346010171025, 4.234557925392575],
        [71.58910531638176, 4.217501537953615],
        [80.26207074328447, 4.176242958372455],
        [88.68483523128404, 4.193242866138167],
        [97.41663102366043, 4.161406492711052],
        [106.23088063270491, 4.134829861372675],
        [110.9414259868693, 4.119386418503164],
        [117.80067911519016, 4.065492298903146],
        [115.74541027617467, 4.018756898427048],
        [113.17243480636087, 3.9519856106061617],
        [109.71326264403953, 3.881860191932492],
        [105.75916035975324, 3.8399628750757966],
        [102.61578825892242, 3.80263582244048],
        [96.79876032264049, 3.72099948031141],
        [87.70974860299168, 3.640939375269923],
        [81.39410298049853, 3.5997458123873827],
        [76.89603370785778, 3.5003633238603653],
        [79.30952023559341, 3.383513222274198],
        [83.60023923410746, 3.2614966389548172],
        [85.00588214941364, 3.129828490440034],
        [85.70880934886448, 3.0128961523117788],
        [87.66413177577246, 2.946434226473123],
        [88.60022573334675, 2.855541211872475],
        [91.54780172128658, 2.761086276477428],
        [93.47726996441435, 2.663591963315166],
        [96.56603957913983, 2.5851887244008434],
        [96.21330469326995, 2.481461061514867],
        [96.89685237405806, 2.378088801315123],
        [97.83659846908007, 2.28385715965375],
        [99.86490875177326, 2.1782409247825445],
        [100.72239075796404, 2.0788591510426135],
        [60.0, 2.498091544796509],
        [53.81449618829484, 2.4087775518032863],
        [50.44799302251776, 2.2579205369363358],
        [47.70744176750625, 2.14717154738608],
        [44.28317965096906, 2.014244663214635],
        [42.44997055358225, 1.8329161680603692],
        [42.01190307520001, 1.5946013529799665],
        [42.42640687119285, 1.4288992721907328],
        [44.27188724235731, 1.2490457723982544],
        [48.33218389437829, 1.1441688336680205],
        [37.33630940518894, 1.9264322110956562],
        [32.31098884280702, 1.9513027039072615],
        [29.68164415931166, 2.5722794624891314],
        [28.319604517012593, 2.4061528859142873],
        [21.37755832643195, 1.7590178320996672],
        [20.223748416156685, 1.4219063791853994],
        [22.360679774997898, 2.677945044588987],
        [16.55294535724685, 2.704965493776252],
        [10.63014581273465, 2.4227626539681686],
        [10.0, 1.5707963267948966],
        [17.46424919657298, 1.3397056595989996],
        [25.495097567963924, 1.373400766945016],
        [29.068883707497267, 1.6396528160959412],
        [32.64965543462902, 2.44293282886833],
        [34.828149534535996, 2.2545056384292677],
        [33.61547262794322, 2.1010120995715265],
        [96.33275663033837, 3.985746639702964],
        [91.92388155425118, 3.9269908169872414],
        [87.11486669908874, 3.870141569654404],
        [80.91971329657564, 3.83949547618485],
        [76.21679604916491, 3.80608805268455],
        [72.91776189653656, 3.878485204746858],
        [70.09279563550022, 3.9774529910040974],
        [95.77577981932593, -0.7040962917890519],
        [90.21086409075129, -0.6279812906708576],
        [84.59905436823747, -0.5748886012700922],
        [79.25906888173743, -0.5144513130590277],
        [74.68600939935136, -0.45765965661689284],
        [68.54195795277518, -0.4048917862850834],
        [63.56886030125127, -0.33667481938672716],
        [58.180752831155424, -0.42520501897961815],
        [56.938563381947034, -0.5343954767544137],
        [56.92099788303083, 3.4633432079864352],
        [56.089214649520635, 3.338988213439674],
        [52.23983154643591, 3.237451800699806],
        [44.01136216933077, 3.164316014431434],
        [36.013886210738214, 3.169363290183214],
        [31.064449134018133, 3.2060194930153467],
        [28.231188426986208, 3.541833310623767],
        [34.9857113690718, 3.682012153860377],
        [42.190046219457976, 3.690142056040321],
        [49.24428900898052, 3.6506635420121762],
        [54.62600113499065, 3.5560995281745793],
        [12.36931687685298, 0.24497866312686414],
        [17.46424919657298, -0.4124104415973873],
        [24.413111231467404, -0.6107259643892086],
        [30.4138126514911, -0.4783524313786575],
        [36.05551275463989, -0.3392926144540447],
        [38.47076812334269, -0.15660187698201536],
        [38.01315561749642, 0.02630971725292219],
        [33.95585369269929, 0.23783592745745075],
        [26.248809496813376, 0.3097029445424562],
        [17.46424919657298, 0.23109066719589708],

    ]


    p.setup = function () {
      p.createCanvas(p.windowWidth*0.99, p.windowHeight*0.8);
      p.noStroke();
      //p.fill(204, 102, 0);
        numPoints = data.length;
        stepTime = (totalTime - travelTime - waitTime)/numPoints

        relOrX = p.windowWidth/2*0.99;
        relOrY = p.windowHeight/2*0.8;

    };

    p.draw = function () {
        p.background(0, 45); // translucent background (creates trails)
        if(relOrX - 300 < 0 || relOrX + 300 >  p.windowWidth*0.99) {
            xVel *= -1;
        }
        if(relOrY - 150 < 0 || relOrY + 150 > p.windowHeight*0.8) {
            yVel *= -1;
        }

        // relOrX += xVel;
        // relOrY += yVel;

        for (let s = 0; s < numPoints; s++) {
            p.fill(Math.random()*255, Math.random()*255, Math.random()*255);

            let tempT = (t - s*stepTime)%(totalTime*2);

            let orginX = relOrX; //p.windowWidth/2;
            let orginY = relOrY; //p.windowHeight/2;

            rot = 0;
            wave = (t*6.66)%20;

            let ampScaler = 1 - (randData[(c+s)%200]/255)/4

            let endX = data[s][0]*ampScaler*Math.cos(data[s][1] + rot)*scalar;
            let endY = data[s][0]*ampScaler*Math.sin(data[s][1] + rot)*scalar;

            let x = endX + orginX //(tempT%travelTime)/travelTime*(endX) + orginX;
            let y = endY + orginY//(tempT%travelTime)/travelTime*(endY) + orginY;

            // if(tempT >= travelTime) {
            //     x = orginX + endX;
            //     y = orginY + endY;
            // }

            // if(tempT >= totalTime) {
            //     x = (1 - (tempT%travelTime)/travelTime)*(endX) + orginX;
            //     y = (1 - (tempT%travelTime)/travelTime)*(endY) + orginY;
            // }

            // if(tempT >= totalTime + travelTime) {
            //     x = orginX;
            //     y = orginY;
            // }
                // each particle moves in a circle
                const myX = x + 10*Math.cos(Math.PI * tempT*2);
                const myY = y + 10*Math.sin(Math.PI * tempT*2);

                p.ellipse(x, y , 7); // draw particle
        }
    t = t + 0.01; // update time
    c = c + 1;


    };
  };
